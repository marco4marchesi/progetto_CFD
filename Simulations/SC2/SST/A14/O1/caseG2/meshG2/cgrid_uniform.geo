// ===========================================
// ==================================MESH FILE
// ===========================================

h = 0.02;
C = 1.00898;
H = 129.50893464*C;

// =====================================POINTS
Point(1) = {C, 0, 0.0, 20*h};
Point(2) = {1, 0.00126, 0.0, 19.6605*h};
Point(3) = {0.996275, 0.001864, 0.0, 19.5192*h};
Point(4) = {0.990096, 0.00286, 0.0, 19.2849*h};
Point(5) = {0.983171, 0.003969, 0.0, 19.0223*h};
Point(6) = {0.975506, 0.005186, 0.0, 18.7318*h};
Point(7) = {0.967161, 0.006501, 0.0, 18.4155*h};
Point(8) = {0.958242, 0.007894, 0.0, 18.0775*h};
Point(9) = {0.948875, 0.009343, 0.0, 17.7226*h};
Point(10) = {0.939182, 0.010828, 0.0, 17.3555*h};
Point(11) = {0.929263, 0.012333, 0.0, 16.9799*h};
Point(12) = {0.919193, 0.013845, 0.0, 16.5986*h};
Point(13) = {0.909025, 0.015357, 0.0, 16.2137*h};
Point(14) = {0.898794, 0.016862, 0.0, 15.8266*h};
Point(15) = {0.888521, 0.018359, 0.0, 15.4379*h};
Point(16) = {0.878222, 0.019844, 0.0, 15.0483*h};
Point(17) = {0.867904, 0.021317, 0.0, 14.6581*h};
Point(18) = {0.857574, 0.022777, 0.0, 14.2675*h};
Point(19) = {0.847235, 0.024224, 0.0, 13.8766*h};
Point(20) = {0.836889, 0.025656, 0.0, 13.4856*h};
Point(21) = {0.826538, 0.027075, 0.0, 13.0944*h};
Point(22) = {0.816183, 0.028481, 0.0, 12.7032*h};
Point(23) = {0.805825, 0.029872, 0.0, 12.3119*h};
Point(24) = {0.795464, 0.031249, 0.0, 11.9205*h};
Point(25) = {0.785101, 0.032612, 0.0, 11.5292*h};
Point(26) = {0.774736, 0.033962, 0.0, 11.1379*h};
Point(27) = {0.764369, 0.035297, 0.0, 10.7465*h};
Point(28) = {0.754001, 0.036618, 0.0, 10.3552*h};
Point(29) = {0.743632, 0.037925, 0.0, 9.96392*h};
Point(30) = {0.733263, 0.039217, 0.0, 9.5727*h};
Point(31) = {0.722893, 0.040495, 0.0, 9.18151*h};
Point(32) = {0.712523, 0.041758, 0.0, 8.79039*h};
Point(33) = {0.702153, 0.043007, 0.0, 8.39933*h};
Point(34) = {0.691784, 0.04424, 0.0, 8.00838*h};
Point(35) = {0.681416, 0.045458, 0.0, 7.61753*h};
Point(36) = {0.671049, 0.046661, 0.0, 7.22678*h};
Point(37) = {0.660683, 0.047848, 0.0, 6.83614*h};
Point(38) = {0.650319, 0.049018, 0.0, 6.44565*h};
Point(39) = {0.639958, 0.050173, 0.0, 6.05533*h};
Point(40) = {0.629598, 0.051311, 0.0, 5.66512*h};
Point(41) = {0.619242, 0.052431, 0.0, 5.27513*h};
Point(42) = {0.608888, 0.053534, 0.0, 4.88528*h};
Point(43) = {0.598538, 0.054619, 0.0, 4.49565*h};
Point(44) = {0.588191, 0.055686, 0.0, 4.10621*h};
Point(45) = {0.577849, 0.056735, 0.0, 3.71702*h};
Point(46) = {0.567511, 0.057764, 0.0, 3.32805*h};
Point(47) = {0.557177, 0.058773, 0.0, 2.9393*h};
Point(48) = {0.546849, 0.059762, 0.0, 2.55085*h};
Point(49) = {0.536527, 0.06073, 0.0, 2.1627*h};
Point(50) = {0.52621, 0.061676, 0.0, 1.77481*h};
Point(51) = {0.5159, 0.0626, 0.0, 1.38726*h};
Point(52) = {0.505596, 0.063502, 0.0, 1*h};
Point(53) = {0.4953, 0.06438, 0.0, 5.05008*h};
Point(54) = {0.485011, 0.065234, 0.0, 9.09664*h};
Point(55) = {0.474731, 0.066063, 0.0, 13.1389*h};
Point(56) = {0.464459, 0.066867, 0.0, 17.1772*h};
Point(57) = {0.454197, 0.067643, 0.0, 21.2108*h};
Point(58) = {0.443944, 0.068393, 0.0, 25.2401*h};
Point(59) = {0.433701, 0.069114, 0.0, 29.2647*h};
Point(60) = {0.42347, 0.069806, 0.0, 33.2839*h};
Point(61) = {0.41325, 0.070468, 0.0, 37.2979*h};
Point(62) = {0.403042, 0.071099, 0.0, 41.3065*h};
Point(63) = {0.392848, 0.071697, 0.0, 45.3088*h};
Point(64) = {0.382667, 0.072262, 0.0, 49.3053*h};
Point(65) = {0.372501, 0.072793, 0.0, 53.2952*h};
Point(66) = {0.36235, 0.073287, 0.0, 57.2785*h};
Point(67) = {0.352216, 0.073745, 0.0, 61.2545*h};
Point(68) = {0.3421, 0.074165, 0.0, 65.2228*h};
Point(69) = {0.332002, 0.074546, 0.0, 69.1835*h};
Point(70) = {0.321925, 0.074885, 0.0, 73.1353*h};
Point(71) = {0.311869, 0.075182, 0.0, 77.0784*h};
Point(72) = {0.301837, 0.075435, 0.0, 81.0116*h};
Point(73) = {0.291829, 0.075642, 0.0, 84.935*h};
Point(74) = {0.28185, 0.075802, 0.0, 88.8467*h};
Point(75) = {0.2719, 0.075913, 0.0, 92.7468*h};
Point(76) = {0.261984, 0.075973, 0.0, 96.6333*h};
Point(77) = {0.252107, 0.075981, 0.0, 100.505*h};
Point(78) = {0.242274, 0.075934, 0.0, 104.359*h};
Point(79) = {0.232493, 0.07583, 0.0, 108.192*h};
Point(80) = {0.222775, 0.075669, 0.0, 112.002*h};
Point(81) = {0.213136, 0.075448, 0.0, 115.781*h};
Point(82) = {0.203599, 0.075166, 0.0, 119.52*h};
Point(83) = {0.194193, 0.074821, 0.0, 123.209*h};
Point(84) = {0.184949, 0.074405, 0.0, 126.836*h};
Point(85) = {0.175884, 0.073906, 0.0, 130.394*h};
Point(86) = {0.167005, 0.073314, 0.0, 133.882*h};
Point(87) = {0.158316, 0.072621, 0.0, 137.299*h};
Point(88) = {0.149819, 0.07182, 0.0, 140.644*h};
Point(89) = {0.141513, 0.070904, 0.0, 143.919*h};
Point(90) = {0.133401, 0.069871, 0.0, 147.124*h};
Point(91) = {0.125484, 0.068715, 0.0, 150.26*h};
Point(92) = {0.117765, 0.067435, 0.0, 153.327*h};
Point(93) = {0.110249, 0.066031, 0.0, 156.323*h};
Point(94) = {0.102944, 0.064503, 0.0, 159.249*h};
Point(95) = {0.095859, 0.062855, 0.0, 162.1*h};
Point(96) = {0.089006, 0.061093, 0.0, 164.873*h};
Point(97) = {0.082398, 0.059223, 0.0, 167.565*h};
Point(98) = {0.07605, 0.057257, 0.0, 170.169*h};
Point(99) = {0.06998, 0.055207, 0.0, 172.68*h};
Point(100) = {0.064202, 0.05309, 0.0, 175.092*h};
Point(101) = {0.058733, 0.050922, 0.0, 177.398*h};
Point(102) = {0.053584, 0.048723, 0.0, 179.592*h};
Point(103) = {0.048762, 0.046512, 0.0, 181.672*h};
Point(104) = {0.044269, 0.044306, 0.0, 183.633*h};
Point(105) = {0.040103, 0.042122, 0.0, 185.477*h};
Point(106) = {0.036255, 0.039973, 0.0, 187.205*h};
Point(107) = {0.032711, 0.03787, 0.0, 188.82*h};
Point(108) = {0.029455, 0.03582, 0.0, 190.328*h};
Point(109) = {0.026469, 0.033829, 0.0, 191.734*h};
Point(110) = {0.023733, 0.031899, 0.0, 193.047*h};
Point(111) = {0.021227, 0.030029, 0.0, 194.272*h};
Point(112) = {0.018933, 0.028221, 0.0, 195.417*h};
Point(113) = {0.016832, 0.02647, 0.0, 196.489*h};
Point(114) = {0.014907, 0.024775, 0.0, 197.494*h};
Point(115) = {0.013145, 0.023131, 0.0, 198.439*h};
Point(116) = {0.011531, 0.021537, 0.0, 199.328*h};
Point(117) = {0.010054, 0.019988, 0.0, 200.167*h};
Point(118) = {0.008704, 0.01848, 0.0, 200.96*h};
Point(119) = {0.007471, 0.017011, 0.0, 201.712*h};
Point(120) = {0.006348, 0.015576, 0.0, 202.426*h};
Point(121) = {0.005328, 0.014174, 0.0, 203.105*h};
Point(122) = {0.004406, 0.0128, 0.0, 203.754*h};
Point(123) = {0.003578, 0.011454, 0.0, 204.373*h};
Point(124) = {0.00284, 0.010131, 0.0, 204.967*h};
Point(125) = {0.00219, 0.008831, 0.0, 205.537*h};
Point(126) = {0.001627, 0.007553, 0.0, 206.084*h};
Point(127) = {0.001148, 0.006295, 0.0, 206.612*h};
Point(128) = {0.000752, 0.005058, 0.0, 207.121*h};
Point(129) = {0.000441, 0.003842, 0.0, 207.613*h};
Point(130) = {0.000213, 0.002647, 0.0, 208.09*h};
Point(131) = {6.7e-05, 0.001475, 0.0, 208.553*h};
Point(132) = {4e-06, 0.000335, 0.0, 209*h};
Point(133) = {2e-05, -0.00079, 0.0, 208.545*h};
Point(134) = {0.000123, -0.001929, 0.0, 208.083*h};
Point(135) = {0.000323, -0.003079, 0.0, 207.611*h};
Point(136) = {0.000629, -0.004228, 0.0, 207.13*h};
Point(137) = {0.001048, -0.005369, 0.0, 206.639*h};
Point(138) = {0.001584, -0.006491, 0.0, 206.136*h};
Point(139) = {0.00224, -0.007586, 0.0, 205.62*h};
Point(140) = {0.003014, -0.008645, 0.0, 205.09*h};
Point(141) = {0.003904, -0.009666, 0.0, 204.542*h};
Point(142) = {0.004907, -0.010644, 0.0, 203.976*h};
Point(143) = {0.006018, -0.011579, 0.0, 203.389*h};
Point(144) = {0.007237, -0.012472, 0.0, 202.778*h};
Point(145) = {0.008564, -0.013327, 0.0, 202.14*h};
Point(146) = {0.009999, -0.014145, 0.0, 201.472*h};
Point(147) = {0.011547, -0.01493, 0.0, 200.77*h};
Point(148) = {0.013214, -0.015687, 0.0, 200.03*h};
Point(149) = {0.015007, -0.016418, 0.0, 199.247*h};
Point(150) = {0.016938, -0.017127, 0.0, 198.416*h};
Point(151) = {0.019019, -0.017818, 0.0, 197.529*h};
Point(152) = {0.021269, -0.018494, 0.0, 196.579*h};
Point(153) = {0.023707, -0.01916, 0.0, 195.558*h};
Point(154) = {0.02636, -0.019818, 0.0, 194.453*h};
Point(155) = {0.029257, -0.020473, 0.0, 193.252*h};
Point(156) = {0.032434, -0.021128, 0.0, 191.941*h};
Point(157) = {0.035937, -0.021788, 0.0, 190.499*h};
Point(158) = {0.039816, -0.022458, 0.0, 188.908*h};
Point(159) = {0.044131, -0.023144, 0.0, 187.142*h};
Point(160) = {0.04895, -0.023852, 0.0, 185.173*h};
Point(161) = {0.054343, -0.024588, 0.0, 182.972*h};
Point(162) = {0.060377, -0.02536, 0.0, 180.513*h};
Point(163) = {0.067105, -0.026173, 0.0, 177.773*h};
Point(164) = {0.074547, -0.027032, 0.0, 174.744*h};
Point(165) = {0.082683, -0.027941, 0.0, 171.435*h};
Point(166) = {0.091442, -0.028896, 0.0, 167.873*h};
Point(167) = {0.100715, -0.029893, 0.0, 164.102*h};
Point(168) = {0.110374, -0.030922, 0.0, 160.175*h};
Point(169) = {0.120295, -0.031973, 0.0, 156.142*h};
Point(170) = {0.130369, -0.033033, 0.0, 152.047*h};
Point(171) = {0.140511, -0.03409, 0.0, 147.925*h};
Point(172) = {0.150662, -0.035133, 0.0, 143.799*h};
Point(173) = {0.160779, -0.036149, 0.0, 139.689*h};
Point(174) = {0.170837, -0.037129, 0.0, 135.603*h};
Point(175) = {0.180824, -0.038063, 0.0, 131.548*h};
Point(176) = {0.190738, -0.038941, 0.0, 127.524*h};
Point(177) = {0.200592, -0.039755, 0.0, 123.527*h};
Point(178) = {0.210408, -0.040499, 0.0, 119.547*h};
Point(179) = {0.220217, -0.041175, 0.0, 115.572*h};
Point(180) = {0.230037, -0.041788, 0.0, 111.595*h};
Point(181) = {0.239877, -0.042341, 0.0, 107.61*h};
Point(182) = {0.249743, -0.042837, 0.0, 103.617*h};
Point(183) = {0.259637, -0.04328, 0.0, 99.6128*h};
Point(184) = {0.269559, -0.04367, 0.0, 95.5985*h};
Point(185) = {0.279511, -0.04401, 0.0, 91.5728*h};
Point(186) = {0.28949, -0.044302, 0.0, 87.5368*h};
Point(187) = {0.299495, -0.044547, 0.0, 83.4908*h};
Point(188) = {0.309526, -0.044748, 0.0, 79.4347*h};
Point(189) = {0.319582, -0.044905, 0.0, 75.3688*h};
Point(190) = {0.329659, -0.045021, 0.0, 71.2947*h};
Point(191) = {0.339759, -0.045096, 0.0, 67.2114*h};
Point(192) = {0.349879, -0.045131, 0.0, 63.1201*h};
Point(193) = {0.360018, -0.04513, 0.0, 59.0212*h};
Point(194) = {0.370175, -0.045091, 0.0, 54.9149*h};
Point(195) = {0.380349, -0.045017, 0.0, 50.8017*h};
Point(196) = {0.39054, -0.044909, 0.0, 46.6815*h};
Point(197) = {0.400746, -0.044768, 0.0, 42.5551*h};
Point(198) = {0.410966, -0.044595, 0.0, 38.4228*h};
Point(199) = {0.4212, -0.044391, 0.0, 34.2846*h};
Point(200) = {0.431447, -0.044157, 0.0, 30.1409*h};
Point(201) = {0.441707, -0.043894, 0.0, 25.9917*h};
Point(202) = {0.451978, -0.043603, 0.0, 21.8377*h};
Point(203) = {0.46226, -0.043285, 0.0, 17.679*h};
Point(204) = {0.472553, -0.04294, 0.0, 13.5155*h};
Point(205) = {0.482855, -0.042569, 0.0, 9.34792*h};
Point(206) = {0.493167, -0.042173, 0.0, 5.17596*h};
Point(207) = {0.503488, -0.041754, 0.0, 1*h};
Point(208) = {0.513817, -0.041311, 0.0, 1.39423*h};
Point(209) = {0.524154, -0.040845, 0.0, 1.7888*h};
Point(210) = {0.534499, -0.040357, 0.0, 2.18372*h};
Point(211) = {0.54485, -0.039848, 0.0, 2.5789*h};
Point(212) = {0.555208, -0.039317, 0.0, 2.97439*h};
Point(213) = {0.565572, -0.038767, 0.0, 3.37014*h};
Point(214) = {0.575942, -0.038196, 0.0, 3.76617*h};
Point(215) = {0.586317, -0.037606, 0.0, 4.16243*h};
Point(216) = {0.596697, -0.036998, 0.0, 4.55892*h};
Point(217) = {0.607082, -0.036371, 0.0, 4.95565*h};
Point(218) = {0.617471, -0.035726, 0.0, 5.35256*h};
Point(219) = {0.627863, -0.035063, 0.0, 5.74964*h};
Point(220) = {0.63826, -0.034383, 0.0, 6.14694*h};
Point(221) = {0.648659, -0.033687, 0.0, 6.54437*h};
Point(222) = {0.659062, -0.032974, 0.0, 6.94198*h};
Point(223) = {0.669466, -0.032244, 0.0, 7.33969*h};
Point(224) = {0.679874, -0.031499, 0.0, 7.73758*h};
Point(225) = {0.690283, -0.030738, 0.0, 8.13556*h};
Point(226) = {0.700693, -0.029962, 0.0, 8.53361*h};
Point(227) = {0.711105, -0.02917, 0.0, 8.93179*h};
Point(228) = {0.721517, -0.028364, 0.0, 9.33001*h};
Point(229) = {0.731931, -0.027542, 0.0, 9.72835*h};
Point(230) = {0.742344, -0.026706, 0.0, 10.1267*h};
Point(231) = {0.752758, -0.025855, 0.0, 10.5251*h};
Point(232) = {0.763171, -0.02499, 0.0, 10.9236*h};
Point(233) = {0.773584, -0.024111, 0.0, 11.322*h};
Point(234) = {0.783995, -0.023217, 0.0, 11.7205*h};
Point(235) = {0.794406, -0.022308, 0.0, 12.119*h};
Point(236) = {0.804814, -0.021386, 0.0, 12.5174*h};
Point(237) = {0.815221, -0.020449, 0.0, 12.9159*h};
Point(238) = {0.825625, -0.019498, 0.0, 13.3143*h};
Point(239) = {0.836025, -0.018533, 0.0, 13.7125*h};
Point(240) = {0.846421, -0.017554, 0.0, 14.1107*h};
Point(241) = {0.85681, -0.01656, 0.0, 14.5087*h};
Point(242) = {0.867191, -0.015553, 0.0, 14.9064*h};
Point(243) = {0.877561, -0.014531, 0.0, 15.3037*h};
Point(244) = {0.887912, -0.013496, 0.0, 15.7004*h};
Point(245) = {0.898237, -0.012449, 0.0, 16.0961*h};
Point(246) = {0.908521, -0.011391, 0.0, 16.4904*h};
Point(247) = {0.918742, -0.010323, 0.0, 16.8822*h};
Point(248) = {0.928865, -0.009251, 0.0, 17.2704*h};
Point(249) = {0.938837, -0.008179, 0.0, 17.6528*h};
Point(250) = {0.948583, -0.007117, 0.0, 18.0267*h};
Point(251) = {0.958001, -0.006077, 0.0, 18.388*h};
Point(252) = {0.966969, -0.005072, 0.0, 18.7321*h};
Point(253) = {0.975362, -0.004121, 0.0, 19.0542*h};
Point(254) = {0.983071, -0.003237, 0.0, 19.3501*h};
Point(255) = {0.990037, -0.002429, 0.0, 19.6175*h};
Point(256) = {0.996252, -0.001702, 0.0, 19.8561*h};
Point(257) = {1, -0.00126, 0.0, 20*h};
 
// LE points
te = 1;
xte = C;
le = 139; // 132 quello giusto
xle = 0.;

point_test_x = 0.00224;
point_test_y = -0.00756;

LL = 288.85299718*C;

npW = 165;
npN = 146; // mettere 203 per avere il primo layer 5e-5, con 212 invece si ha 3.1e-5
npP = 148;
npS = 242;

progN = 1.0925;
progW = 1.069;
bmpS = 0.0460;
bmpP = 0.0280;
progCS = 1.051;
progCP = 1.06;

// UPPER TRAILING EDGE
Point(401) = {LL, 0, 0};
Point(402) = {LL, H, 0};
Point(403) = {1, H, 0};

Line(400) = {1,401};
Line(401) = {401,402};
Line(402) = {402,403};
Line(403) = {403,1};

Transfinite Line{400} = npW Using Progression progW;
Transfinite Line{402} = npW Using Progression 1/progW;

Transfinite Line{401} = npN Using Progression progN;
Transfinite Line{403} = npN Using Progression 1/progN;

Line Loop(400) = {400,401,402,403};
Plane Surface(400) = {400};
Transfinite Surface{400};
Recombine Surface{400};


// LOWER TRAILING EDGE
Point(502) = {LL, -H, 0};
Point(503) = {1, -H, 0};

Line(501) = {401,502};
Line(502) = {502,503};
Line(503) = {503,1};

Transfinite Line{502} = npW Using Progression 1/progW;

Transfinite Line{501} = npN Using Progression progN;
Transfinite Line{503} = npN Using Progression 1/progN;

Line Loop(500) = {-503,-502,-501,-400};
Plane Surface(500) = {500};
Transfinite Surface{500};
Recombine Surface{500};

// SUCTION SIDE 
Point(601) = {-108.161290 ,-71.812284,0};
Point(600) = {xte, 0 ,0};

Circle(600) = {403,600,601};
Line(601) = {601, le};
Spline(602) = {te:le};

Line Loop(600) = {-403,600,601,-602};

Transfinite Line{601} = npN Using Progression 1/progN;

Transfinite Line{600} = npS Using Progression progCS;
Transfinite Line{602} = npS Using Bump bmpS;

Plane Surface(600) = {600};
Transfinite Surface{600};
Recombine Surface{600};


// PRESSURE SIDE
Circle(800) = {601,600,503};
Spline(801) = {le:257,1};

Transfinite Line{800} = npP Using Progression 1/progCP;
Transfinite Line{801} = npP Using Bump bmpP;

Line Loop(800) = {-601,800,503,-801};
Plane Surface(800) = {800};
Transfinite Surface{800};
Recombine Surface{800};

Physical Surface(1) = {400,500,600,800};
Physical Line("AIRFOIL") = {602,801};
Physical Line("FARFIELD") = {401,402,600,800,-502,-501};

// 1: MeshAdapt, 2: Automatic, 3: Initial mesh only, 5: Delaunay, 6: Frontal-Delaunay, 7: BAMG, 8: Frontal-Delaunay for Quads, 9: Packing of Parallelograms
//Mesh.Algorithm = 1;

//Mesh.RandomFactor = 1e-09;
//Mesh.Smoothing = 10;

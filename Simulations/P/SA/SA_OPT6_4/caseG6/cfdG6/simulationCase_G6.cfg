%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SU2 configuration file _______________________________________________%
% Case description: Static incompressible simulation of NACA 23012 _____%
% Author: Marco Marchesi _______________________________________________%
% Date: 01-11-2022 _____________________________________________________%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% PART 1: DEFINITION OF THE MATHEMATICAL PROBLEM:----------------------%

% --- select solver:
SOLVER= INC_RANS

% --- select turbulence model: (SA o SST)
KIND_TURB_MODEL= SA

% --- kind of mathematical problem:
MATH_PROBLEM= DIRECT

% --- restart solution?
RESTART_SOL= YES

% --- other options:
SYSTEM_MEASUREMENTS= SI
INC_ENERGY_EQUATION= NO

%% PART 2: FLOW CONDITIONS (incompressible flow): ----------------------%

% --- density:
INC_DENSITY_MODEL= CONSTANT
INC_DENSITY_INIT= 1.2

% --- temperature:
INC_TEMPERATURE_INIT= 288.15

% --- velocity - at 18 degrees:
INC_VELOCITY_INIT= ( 9.0541, 2.9418, 0.0 )

% --- inlet:
INC_INLET_TYPE= VELOCITY_INLET
INC_INLET_DAMPING= 0.1

% --- outlet:
INC_OUTLET_TYPE= PRESSURE_OUTLET
INC_OUTLET_DAMPING= 0.1

% --- viscosity: 
VISCOSITY_MODEL= CONSTANT_VISCOSITY
MU_CONSTANT= 1.92E-5

%% PART 3: REFERENCE VALUE DEFINITION:----------------------------------%

% --- moment - reference pole:
REF_ORIGIN_MOMENT_X = -0.756
REF_ORIGIN_MOMENT_Y = 0.00
REF_ORIGIN_MOMENT_Z = 0.00

% --- reference length pitch, roll, yaw non-dimensional moment
% value from new generated mesh
REF_LENGTH= 1.008

% --- reference area for non-dimensional force coefficients:
REF_AREA= 1.0

% --- reference viscosity value
MU_REF= 1.92E-5


%% PART 4: BOUNDARY CONDITION DEFINITION: ------------------------------%

% --- NS boundary markers
MARKER_HEATFLUX= (AIRFOIL, 0.0)
MARKER_FAR= (FARFIELD)
MARKER_MONITORING= (AIRFOIL)
MARKER_PLOTTING= (AIRFOIL)


% Boundary conditions for turbolent SA
% [Turbolence intensity from Zanotti 2014 paper]
FREESTREAM_NU_FACTOR= 3

% PART 5: DYNAMIC MESH DEFINITION: -------------------------------------%

GRID_MOVEMENT= NONE % if none, the following parameters can be ignored

% --- mach initialization for dynamic mesh
MACH_MOTION= 0.8

% --- Coordinates of the motion origin
MOTION_ORIGIN= -0.756 0.0 0.0

% --- Angular velocity vector (rad/s) about the motion origin
ROTATION_RATE = 0.0 0.0 0.0

% --- Pitching angular freq. (rad/s) about the motion origin
PITCHING_OMEGA= 0.0 0.0 0.0

% --- Pitching amplitude (degrees) about the motion origin
PITCHING_AMPL= 0.0 0.0 0.0

% --- Pitching phase offset (degrees) about the motion origin
PITCHING_PHASE= 0.0 0.0 0.0

%% PART 6: PARAMETERS FOR THE NUMERICAL METHODS:------------------------%

% --- spatial gradients numerical method:
NUM_METHOD_GRAD= GREEN_GAUSS
NUM_METHOD_GRAD_RECON = LEAST_SQUARES

% --- CFL - Courant-Friedrichs-Lewy condition
CFL_NUMBER= 2.0
CFL_ADAPT = YES
CFL_ADAPT_PARAM= ( 0.1, 1.2, 1.0, 1e3 )

% --- end simulation parameters:
MAX_DELTA_TIME= 1E20
ITER= 29999

% PART 7: SOLVER DEFINITION: -------------------------------------------%

% --- linear solver for implicit formulations:
LINEAR_SOLVER= FGMRES
LINEAR_SOLVER_PREC= ILU
LINEAR_SOLVER_ERROR= 1E-6
LINEAR_SOLVER_ITER= 10

% PART 8: MULTIGRID PARAMETERS: ----------------------------------------%

% --- set multigrid levels, 0 for no multigrid:
MGLEVEL = 0

% --- multi grid cycle:
MGCYCLE = V_CYCLE

% --- other parameters:
MG_PRE_SMOOTH= (1, 2, 3, 4)
MG_POST_SMOOTH= (0, 0, 0, 0)
MG_CORRECTION_SMOOTH= (0, 0, 0, 0)
MG_DAMP_RESTRICTION= 0.8    %residual
MG_DAMP_PROLONGATION= 0.8   %correction

% PART 9: SLOPE LIMITER AND DISSIPATION DEFINITION:--------------------%

% --- muscl flow?
MUSCL_FLOW= YES
MUSCL_TURB= NO

% --- venkatakrishnan slope limiter for upwind schemes (in our case for FDS):
SLOPE_LIMITER_FLOW= VENKATAKRISHNAN
VENKAT_LIMITER_COEFF= 0.01

% --- slope limiter for second and fourth order artificial dissipation (in our case JST):
JST_SENSOR_COEFF= (0.5, 0.02)

% PART 10: NUMERICAL METHOD DEFINITION FOR FLOW: -----------------------%

% --- numerical scheme:
CONV_NUM_METHOD_FLOW= FDS
CONV_NUM_METHOD_TURB= SCALAR_UPWIND

% --- time discretization: 
TIME_DISCRE_FLOW= EULER_IMPLICIT
TIME_DISCRE_TURB= EULER_IMPLICIT

% PART 11: CONVERGENCE PARAMETERS: -------------------------------------%

% --- define the parameters of convergence
CONV_FIELD= (RMS_PRESSURE, DRAG)

% --- define the minimum residual value (log10 of it)
CONV_RESIDUAL_MINVAL= -9 

% --- start applying convergence criteria after N iteration:
CONV_STARTITER= 10

% --- number of cauchy elements to apply the criteria:
CONV_CAUCHY_ELEMS= 250

% --- epsilon parameter:
CONV_CAUCHY_EPS=  1E-6

% PART 12: INPUT/OUTPUT INFORMATION ------------------------------------%


% Mesh input file
MESH_FILENAME= ../meshG6/meshG6.su2

% Mesh input file format (SU2, CGNS, NETCDF_ASCII)
MESH_FORMAT= SU2

% Mesh output file
MESH_OUT_FILENAME= mesh_out_G6.su2

% Restart flow input file
SOLUTION_FILENAME= ../../../P13/caseG6/cfdG6/restart_flow_G6.dat

% Restart adjoint input file
SOLUTION_ADJ_FILENAME= solution_adj.dat

% Output file format (PARAVIEW, TECPLOT, STL)
TABULAR_FORMAT= CSV

% Output file convergence history (w/o extension) 
CONV_FILENAME= history_G6

% Output file restart flow
RESTART_FILENAME= restart_flow_G6.dat

% Output file flow (w/o extension) variables
VOLUME_FILENAME= flow_G6

% Output file surface flow coefficient (w/o extension)
SURFACE_FILENAME= surface_flow_G6

% Output file surface adjoint coefficient (w/o extension)
SURFACE_ADJ_FILENAME= surface_adjoint

% Writing solution file frequency
OUTPUT_WRT_FREQ= 200

% Writing convergence history frequency
SCREEN_WRT_FREQ_INNER= 10

% Writing convergence history frequency
HISTORY_WRT_FREQ_INNER= 1

% Screen output fields 
HISTORY_OUTPUT= (INNER_ITER, MIN_CFL, MAX_CFL, RMS_RES, LIFT, DRAG, MOMENT_Z)
SCREEN_OUTPUT= (INNER_ITER, MAX_CFL, RMS_PRESSURE, CAUCHY, DRAG)
VOLUME_OUTPUT= (COORDINATES, SOLUTION, PRIMITIVE, RESIDUAL, MESH_QUALITY)
